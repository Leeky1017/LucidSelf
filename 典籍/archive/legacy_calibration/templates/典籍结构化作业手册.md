# 典籍结构化作业手册（L1 → L2 → 因子层 → L3）

## 📋 版本说明

**当前版本**: v2.0-python-semantic (2025-11-24)  
**生效日期**: 2025-11-24  

### 版本历史

- **v2.0-python-semantic (现行标准)**: L2 语义采用 **Python 类定义 + PostgreSQL 存储 + Redis 缓存**架构，彻底废弃 JSONL 文件方式。
- **v1.1-bilingual (已过时)**: 在 v1 基础上增加双语支持，L1/L2 必须包含中英术语对齐。
- **v1 (已过时)**: L3 规则采用 **Python-as-Rule** 方式编写，不再使用 JSON DSL / YAML 原型。
- **v0 (已废弃)**: L2 使用 JSONL 文件，L3 使用 JSON DSL + YAML 原型。

### v2.0 架构关键特性

| 层级 | v0/v1 (已废弃) | v2.0 (现行标准) |
| :--- | :--- | :--- |
| **L2 存储** | ❌ data/semantics/*.jsonl | ✅ Python 类 + PostgreSQL + Redis |
| **L2 定义方式** | ❌ 手写 JSONL 对象 | ✅ Python @SemanticRegistry.register |
| **L3 载体** | ❌ JSON DSL / YAML 原型 | ✅ Python 函数 + RuleRegistry |
| **类型安全** | ❌ 无类型检查 | ✅ Python 类型提示 + IDE 支持 |
| **查询性能** | ❌ 文件扫描，慢 | ✅ PostgreSQL 索引 + Redis 缓存 |
| **维护成本** | ❌ 高（格式冗长） | ✅ 低（代码即文档） |
| **双语支持** | ⚠️ v1.1 才强制 | ✅ 内置双语字段 |

> 自 v2 起，模板分工为：  
> - L1/L2 + 因子层：`典籍/精校模板_L1L2_v2.md` 为唯一现行精校模板；  
> - L3/L4 内容层：`典籍/结构化提取_L3L4_v2.md`；  
> - L3 Python 工程层：由工程代码与 backend 文档统一约定，本手册只约定内容与层级边界。

---

本手册面向 **负责典籍结构化作业的 agent**，统一说明：任意一条典籍，从 L1 精校到 L3 规则的标准流程与边界。

> **重要约定：**从现在起，所有典籍的结构化作业一律以《滴天髓·通天论》1–8 条的实践为 **标准样板**，按本手册执行。

---

## ⚙️ L2/L3 审计与标记规范

**【系统级迁移任务：仅用于旧文档清理；新条目日常精校可直接跳过本节】**

**生效日期**: 2025-11-19  
**适用阶段**: Phase 1.5 - Classic Texts Audit

### 目的

在 v0 → v1 架构迁移过程中，需要对历史典籍文件进行 **L2/L3 污染扫描与清理**，确保：
- L2 语义层不包含逻辑判定字段（`is_xxx`, `triggered`, `pattern` 等）
- L3 规则内容被明确标记，为后续 Python 迁移预留锚点
- 所有变更可追溯，不丢失已完成的结构化成果

### 审计文件

**审计报告**: `典籍/audit/典籍_L2_L3_audit.md`

该文件包含：
1. 所有典籍相关文件的清单（`典籍/**`）
2. 文件分类（L1_only / L2_only / L2_L3_mixed / other）
3. 混合文件的详细统计（约 106+ 处 L3 规则需标记）
4. 后续迁移的 L3_CANDIDATE 记录

> **注**: `data/semantics/` 目录已废弃，所有语义数据已迁移到 Python + PostgreSQL 架构

### 标记规范

对于包含 L2 和 L3 混合内容的文件，使用以下注释标记：

#### L1 原文段落

```markdown
<!-- L1_BEGIN -->
原文：甲木参天，脱胎要火……
<!-- L1_END -->
```

#### L2 释义与因子层

```markdown
<!-- L2_BEGIN -->
- 语义提取（L2）：
  - **主题**：……
  - **自然属性**：……

- 语义因子提取（因子层）：
  | 因子类型 | 因子标签 | …… |
<!-- L2_END -->
```

#### L3 规则候选内容

```markdown
<!-- L3_CANDIDATE_BEGIN id="dts_jiamu_spring_001" source="滴天髓·通神论·甲木条" -->
- 规则提取（L3）：
  | 规则编号 | 规则标签 | 条件 | 结果 |
  | R1       | ……      | ……  | ……  |
<!-- L3_CANDIDATE_END -->
```

**标记字段说明**:
- `id`: 规则候选 ID，格式为 `典籍简称_主题_序号`（如 `dts_jiamu_spring_001`）
- `source`: 原文出处，精确到章节或条目（如 "滴天髓·通神论·甲木条"）

### 强制约束

1. **不得删除任何典籍原文或释义内容**
2. **只添加注释包裹，不改变文件内容顺序**
3. **L2 层禁止包含逻辑判定字段**：
   - 禁止：`is_xxx = true/false`
   - 禁止：`triggered`, `match`, `pattern_matched` 等布尔字段
   - 禁止：硬编码的 `if-then` 判定逻辑
4. **所有被剥离的逻辑字段必须记录在 L3_CANDIDATE 块中**

### 工作流程

1. **Task 1.5.1**: 扫描并分类所有典籍文件 → ✅ 已完成
2. **Task 1.5.2**: 对混合文件添加注释标记 → ⏭️ 待执行
3. **Task 1.5.3**: 清理 L2 中的逻辑判定字段 → ⏭️ 待执行
4. **Task 1.5.4**: 更新规范文档与 OpenSpec → ⏭️ 待执行

### 后续 Python 迁移

所有被标记为 `L3_CANDIDATE` 的内容，将在后续阶段逐步迁移为 Python 规则函数：
- 使用 `@RuleRegistry.register` 装饰器
- 返回 `RuleResult` 对象
- 引用 L2 语义数据和因子层

详见：工程侧关于 `RuleRegistry` / `RuleResult` 的实现与注释（以 Python 规则代码为最终标准）。

---

## 0. 名词对齐与作用范围

- **L1（精校层） ≈ Layer 1 / source_texts**  
  - 对应架构文档中的 `source_docs` / `source_texts`，是一条在上下文中可独立引用的原文片段。  
  - 只做文本层面的校勘、解释与多层解读，不直接进入数据库 Schema 设计。
- **L2（语义层） ≈ Layer 2 / semantic_cores**  
  - 对应规则库设计文档中的 `semantic_cores`，每条 L2 最终会对应 1 个 `semantic_core`，拥有唯一 `semantic_id`。  
  - **v2.0 实现**: L2 通过 Python 类定义（继承 `SemanticEntry`），使用 `@SemanticRegistry.register` 装饰器注册，自动同步到 PostgreSQL。  
  - 在内容作业阶段，精校完成后在 `典籍/{书名}/semantic/` 目录创建 Python 文件；工程侧复制到 `backend/semantics/{book_id}/` 部署。
- **因子层（语义因子七列表）**  
  - 作为 L2 → L3 的桥接层，帮助把自然语言语义拆成可复用的「因子」。  
  - 因子本体与 ID 由工程侧维护，本手册只约定如何在条目内部使用 `existing` / `new_candidate` 做标注。
- **L3（规则层） ≈ Layer 3 / Python Rules**  
  - 对应规则库中的 Python 规则函数，用 if–then 结构表达「在什么条件下，在哪个维度产生怎样的结论」。  
  - 每条 L3 规则都应能追溯到 1 个或少数几个 L2 `semantic_core`（即规则中的 `source` 参数）。  
  - **v1 变更**: 不再使用 JSON DSL 或 YAML 原型，直接编写 Python 函数并通过 `@RuleRegistry.register` 装饰器注册。  
  - **适用典籍范围**：本手册适用于所有典籍，包括中文古籍与西方经典（占星、梦学、塔罗等）；西方典籍的 L1 以原文为基准（可带对照翻译），L2/因子层一律按本手册字段结构执行，不允许另起一套「西方专用模板」。

## 1. 总览：从 L1 到 L3 的完整流程

### 1.1 Markdown 精校阶段（内容侧）

1. **L1 精校（按《精校模板_L1L2_v2》）**  
   使用 `典籍/精校模板_L1L2_v2.md` 的 L1 部分：完成断句、原注/补注、分字/分词、白话解释与多层解释（字面 / 象征 / 现实 / 心理）。

2. **L2 语义提取（按《精校模板_L1L2_v2》）**  
   使用 `典籍/精校模板_L1L2_v2.md` 中的 L2 小节：提取主题、自然属性、功能象义、条件（必要 / 增强 / 失效）等结构化要点。  
   **⚠️ 强约束**: L2 严禁包含任何逻辑判定字段（如 `is_xxx_pattern: true/false`），只做纯语义描述。

3. **因子层（同条目内的七列表）**  
   在同一条目下按 `典籍/精校模板_L1L2_v2.md` 的因子层规范填写「语义因子提取（因子层）」七列表：  
   仅用 `existing` / `new_candidate` 标记因子来源，不创造新的因子 ID 字符串。

### 1.2 Python 语义层阶段（v2.0 新增）

4. **创建 Python 语义文件**  
   在 `典籍/{书名}/semantic/` 目录下创建 `.py` 文件，将 Markdown L2 内容转换为 Python 类定义：
   - 使用 `@SemanticRegistry.register` 装饰器注册
   - 字段完全对应 L2 模板（`original_text`, `normalized_text_zh`, `subject`, `factor_refs` 等）
   - 参考示例：`backend/semantics/dts/_example.py`

5. **部署到工程目录（工程侧）**  
   将 `semantic/*.py` 文件复制到 `backend/semantics/{book_id}/`，系统启动时自动：
   - 通过 `SemanticRegistry` 注册所有语义条目
   - 同步到 PostgreSQL 数据库
   - 建立 Redis 缓存索引

### 1.3 L3 规则层（可选，有因果结构才写）

6. **L3 Python 规则（工程层）**  
   若该条存在清晰的 "**如果……那么……**" 结构，在 `backend/rules/` 编写 Python 规则函数：
   - 使用 `@RuleRegistry.register` 装饰器注册
   - 返回 `RuleResult` 对象
   - 引用 L2 语义的 `semantic_id`
   - 详见：工程内规则模块（例如 `backend/core/rules`）中的文档与注释。

---

## 2. L1 精校作业规范（引用《精校模板_L1L2_v2.md》）

### 2.1 唯一权威模板

- L1/L2 精校与因子层的唯一现行模板为：`典籍/精校模板_L1L2_v2.md`。
- 旧版 `典籍/精校模板.md` 作为历史模板保留，不再新增用法，仅供参考。
- 本手册 **不重定义字段**，只总结最低完成标准与职责边界；字段含义与完整结构以 v2 模板文件为准。

### 2.2 一条 L1「完成」的最低标准

对于任意一条典籍（如某条经文、梦例、论段），满足以下五点才视为 L1 完成：

1. **断句后的原文**  
   - 使用现代标点对原文断句，必要时分段。  
   - 保留原文用字，校勘改动需在说明中标注。

2. **原注 / 必要补注**  
   - 有原书自带注解时，应整理为「原注」；  
   - 需要补充背景、典故、异文时，可加少量「补注」。

3. **分字 / 分词释义**  
   - 按关键字或短语逐项释义，说明本条中的专用含义；  
   - 优先解释与后续结构化有直接关系的词。

4. **白话解释**  
   - 用一段或若干段连贯的现代中文，重述整条原意；  
   - 要求内容自洽、能被非专业读者理解。

5. **多层解释**  
   - 至少包含：
     - **字面义**：就词面、画面而言的直接意思；
     - **象征义**：在术数 / 象征系统中的意涵；
     - **现实义**：在现实命例 / 生活场景中的对应；
   - 如条件允许，建议补充 **心理义**（心理机制、心态模式等）。

### 2.3 L1 的职责边界

- L1 **不负责**：
  - 正式因子入库；
  - 正式 L3 规则定义；
  - 与推理引擎结构直接对接。
- 在 L1 的「详细解说」中：
  - 可以自由提到潜在因子、条件、规则思路，但一律视为 **非结构化草稿**；
  - **不计入** L2 / 因子层 / L3 的正式结果。

---

## 3. L2 + 因子层作业规范（引用《精校模板_L1L2_v2.md》）

### 3.1 L2 语义提取规范

- L2 的模板与字段定义来自：`典籍/精校模板_L1L2_v2.md` 中的「语义提取（L2）」小节。  
- 每条 L1 可以拆解为 1 条或多条 L2 语义单元，依据内容复杂度与后续推理需要。  
- 在规则库与数据库中，每条 L2 语义单元对应 1 个 `semantic_core` 记录，并在入库后分配唯一 `semantic_id`；内容作业阶段只需保证语义边界清晰、便于后续一一映射。

**每条 L2 至少包含：**

1. **主题**  
   - 本条语义聚焦的核心对象 / 场景 / 机制。  
   - 示例：日主类型、梦境主题、人物角色关系等。

2. **自然属性**  
   - 与该主题相关的客观属性，如：五行、阴阳、方位、时间段等。  
   - 用于后续因子与规则的客观条件建模。

3. **功能象义**  
   - 本条在体系中的功能、作用或象征意义；  
   - 抽象总结「用来干什么」「指向什么效果」。

4. **条件结构**（有则填，无则可略）  
   - **必要条件**：不满足就不能成立的前提；
   - **增强条件**：有利于效果强化的加分因素；
   - **失效条件**：出现时会削弱或完全破坏原命题的情形。

5. **多层解释（结构化浓缩版）**  
   - 将 L1 的多层解释，压缩为要点式 bullet，例如：
     - 字面层：……
     - 象征层：……
     - 实践/现实层：……
     - 心理层（如有）：……

**写法要求：**

- 使用 bullet 列表，每条是**完整要点句**，避免长篇散文；
- 尽量 **对应原文具体句子或片段**，不要发散到与本条无关的推理；
- 允许适度一般化，但必须能在原文中找到明确依据。

**⚠️ v1 强约束：禁止在 L2 中包含逻辑判定**

L2 是**纯语义层**，只负责描述"是什么"，不负责判定"是否成立"。以下类型的字段**严禁出现在 L2**：

- ❌ **布尔判定字段**：如 `is_xxx_pattern: true`、`triggered: false`
- ❌ **成立与否的结论**：如 `pattern_valid: true`、`condition_met: false`
- ❌ **匹配状态**：如 `matched: true`、`applicable: false`

**正确示例（v1）**：
```yaml
L2:
  subject: "甲木日主"
  necessary_conditions:
    - "日主为甲木"
    - "木有根气"
  factor_scores:
    wood_strength: 0.75  # 描述性数值，不是判定结果
```

**错误示例（v0，已禁用）**：
```yaml
L2:
  subject: "甲木日主"
  is_strong_wood: true  # ❌ 这是逻辑判定，应移至 L3
  pattern_matched: false  # ❌ 这是规则执行结果，不属于 L2
```

**边界说明**：
- L2 可以包含**描述性的因子分值**（如 `wood_strength: 0.75`），这表示"木的力量程度"，是客观属性。
- L2 **不能**包含**判定性的布尔值**（如 `is_strong: true`），这表示"是否符合某规则"，属于 L3 逻辑。

**如果在历史文档中发现 L2 有此类字段**：
1. 通过 `L3_CANDIDATE` 注释等方式标记为「待迁移到 L3」；
2. 在后续的 Python 规则中实现该判定逻辑；
3. 由系统级任务统一从 L2 数据中删除该字段。精校 agent 仅在自己本次编辑条目范围内避免新增此类字段，不单兵全库搜改。

### 3.2 语言与翻译原则（L1/L2 阶段强制要求）

#### 3.2.1 典籍语种定位

1. **典籍按原语种定主语种**：
   - **中文古籍**（滴天髓、子平真诠、三命通会、梦林玄解等） → **主语种=中文**，英文只做简明释义
   - **英文典籍**（西方占星、塔罗、梦学等） → **主语种=英文**，中文只做简明释义

2. **在 L1/L2 精校阶段必须完成**：
   - **主语种规范化释义**：完整、准确、流畅的规范化解释
   - **次语种一句话简释**：核心概念的精炼翻译（**不是逐句翻译**）
   - **术语对齐表**：对本条涉及的关键术语，建立 `term_zh / term_en / def_zh / def_en` 对应关系

3. **翻译深度约束**：
   - **不是全文翻译**：次语种只提供一句话核心释义
   - **不是逐段对应**：保持语义核心即可，无需句句对译
   - **不是文学翻译**：准确性和术语规范性优于文采

#### 3.2.2 术语管理原则

1. **先登记后使用**：
   - 新术语必须先在因子本体中登记（或标记为 new_candidate）
   - 禁止在精校中随意创造术语翻译

2. **统一不重复**：
   - 同一术语在全库范围内保持唯一中英对应
   - 同义词通过 aliases 处理，不另立术语

3. **双语强制配对**：
   - 每个术语必须同时有中英文标签
   - 定义可根据语种习惯适度调整表达，但语义必须一致

#### 3.2.3 后续处理

- **L3/L4 和 Playbook 一律只基于**：
  - 因子 ID（如 `bazi_qisha`、`astro_saturn`）
  - 术语表中已对齐好的中英文术语
  - 不再做临时翻译或自由发挥

### 3.3 因子层七列表规范

在每条 L2 之后，补充「语义因子提取（因子层）」表，统一采用 **七列结构**：

> **表头固定为：**
>
> 因子类型 | 因子标签（人话） | 因子ID（如已存在） | 因子来源 | 角色/位置 | 取值/约束 | 备注

#### 3.3.1 各列含义（简要）

- **因子类型**：
  - 如结构类 / 状态类 / 时间类 / 边界类 / 关系类 / 能量类等；
  - 优先参照工程侧因子本体（如 `lucidself_factor_ontology`）。

- **因子标签（人话）**：
  - 面向内容侧的人类可读标签，用自然语言完整描述因子含义；
  - 可以是中/英或中英结合，关键是 **清晰、可复用**。

- **因子ID（如已存在）**：
  - 对应工程侧因子本体中的 **唯一 ID**（如 `dts_day_master_structure` 等）；
  - 若尚未在因子本体中登记，则 **留空**，不得乱造。

- **因子来源**：
  - `existing`：表示该因子已经在因子本体中存在，并有稳定的 ID；
  - `new_candidate`：表示仅为本条从内容侧提出的候选因子，目前 **尚未入库**。

- **角色/位置**：
  - 说明该因子在条目中的角色（如「日主」「用神」「环境层」「梦者本人」「配角」等）；
  - 或在结构中的位置（如「年柱」「梦境场景」「对方角色」）。

- **取值/约束**：
  - 说明该因子的典型取值类型、范围、阈值或枚举；
  - 如「五行之一」「强 / 中 / 弱」「布尔」「0–1 实数」等。

- **备注**：
  - 用于临时补充、与其它因子关系说明、版本记录等。

#### 3.2.2 因子 ID 使用规则

- **只能填写已经存在于因子本体 / 因子词典中的 ID**：
  - 如工程侧维护的 `lucidself_factor_ontology.md`、相关 JSON/Schema 等；
  - 需能在这些资料中找到一一对应的定义。

- **查不到就留空**：
  - 禁止在「因子ID」列中发明新的字符串；
  - 新概念一律通过「因子来源 = new_candidate」 + 「因子标签（人话）」来表达。

#### 3.2.3 因子来源（existing / new_candidate）规则

- **因子来源 = existing**：
  - 表示该因子已经正式入库；
  - 要求同时填写对应的 **因子ID**；
  - 允许在 Python 规则和语义类中被直接引用。

- **因子来源 = new_candidate**：
  - 表示该因子目前仍是内容侧提出的候选；
  - 此时「因子ID」列必须留空，**不得先行造 ID**；
  - 后续若要在工程侧使用，必须走统一的「因子入库变更流程」（命名、定义、评审）。

> **强制约束（写死规则）：**  
> **任何 Python 规则函数、语义类定义、推理引擎，只能直接使用「因子来源 = existing」的因子 ID；`new_candidate` 只能做前期语义标注，不允许直接写入代码。**

### 3.3 因子层写作

- 一条 L2 可以对应 1–N 个因子，按分析需要拆解；
- **因子标签（人话）** 应尽量与以后可能的工程字段保持可映射关系，但不必一开始就强行对齐名称；
- 当多个条目出现高度类似的 `new_candidate` 因子标签时，应记录在单独的因子候选清单中，统一推进入库，而不是各自发明略有差异的说法。

---

## 4. Python 语义层实施规范（v2.0 核心）

### 4.1 数据流与目录结构

**完整数据流**：

```
典籍/{书名}/编辑/*.md (L1+L2 Markdown 精校稿)
         ↓
典籍/{书名}/semantic/*.py (Python 语义桥接层)
         ↓
backend/semantics/{book_id}/*.py (工程部署层)
         ↓
PostgreSQL + Redis (运行时存储)
```

**目录组织示例**：

```
典籍/中文典籍/滴天髓/
├── 编辑/
│   ├── 滴天髓_L1L2_通天论.md  # Markdown 精校稿
│   └── ...
├── semantic/
│   ├── README.md
│   ├── tiangan.py             # Python 语义定义
│   └── ...

backend/semantics/dts/
├── __init__.py
├── tiangan.py                  # 从典籍/semantic/复制
└── ...
```

### 4.2 Python 类定义规范

#### 4.2.1 基本格式

```python
from backend.semantics.core.base import SemanticEntry, SemanticRegistry

@SemanticRegistry.register(
    semantic_id="dts_v2_jia_001",
    book_id="dts"
)
class 甲木参天(SemanticEntry):
    """
    滴天髓·天干·甲木第一条
    
    原文：甲木参天，脱胎要火
    """
    
    # L1 层内容
    original_text = "甲木参天，脱胎要火"
    
    # L2 层内容
    normalized_text_zh = "甲木如参天大树，需要火来温养生发..."
    normalized_text_en = "Jia Wood like towering tree needs Fire..."
    
    subject = "甲木日主的季节宜忌与五行平衡"
    
    natural_attributes = {
        "symbolism": ["参天大树", "阳木"],
        "characteristics": ["刚健", "向上"]
    }
    
    necessary_conditions = ["日主为甲木", "需要考虑季节因素"]
    enhancing_conditions = ["地润天和（水火既济）", "得火温养"]
    failing_conditions = ["春见强金", "秋见重土"]
    
    interpretation_modes = {
        "literal": "甲木生长需要合适的环境条件",
        "symbolic": "人的成长需要适合的时机和助力",
        "practical": "根据不同季节调整五行配置策略"
    }
    
    # 因子引用（仅 existing 因子）
    factor_refs = ["day_master_jia", "season_spring"]
    
    # 双语术语对齐
    terms = [
        {
            "term_zh": "甲木",
            "term_en": "Jia Wood",
            "def_zh": "十天干之首，阳木",
            "def_en": "First Heavenly Stem, Yang Wood"
        }
    ]
```

#### 4.2.2 字段映射表

| Markdown L2 字段 | Python 字段 | PostgreSQL 列 | 必填 |
|-----------------|-------------|---------------|-----|
| 原文 | `original_text` | `original_text` | ✅ |
| 规范化释义（中文） | `normalized_text_zh` | `normalized_text_zh` | ✅ |
| 完整对等诠释（英文） | `normalized_text_en` | `normalized_text_en` | ⭕ |
| 主题 | `subject` | `subject` | ✅ |
| 自然属性 | `natural_attributes` | `natural_attributes` (JSONB) | ⭕ |
| 必要条件 | `necessary_conditions` | `necessary_conditions` (JSONB) | ⭕ |
| 增强条件 | `enhancing_conditions` | `enhancing_conditions` (JSONB) | ⭕ |
| 失效条件 | `failing_conditions` | `failing_conditions` (JSONB) | ⭕ |
| 多层解释 | `interpretation_modes` | `interpretation_modes` (JSONB) | ⭕ |
| 因子引用 | `factor_refs` | `factor_refs` (TEXT[]) | ✅ |
| 术语对齐 | `terms` | `terms` (JSONB) | ⭕ |

### 4.3 强制约束

#### 4.3.1 禁止事项

❌ **绝对禁止**：
- 不得创建 `.jsonl` 文件
- 不得编写 JSON DSL 规则
- 不得在 Python 外的格式存储语义
- 不得在语义类中包含 `is_xxx = true/false` 布尔判定
- 不得引用 `new_candidate` 状态的因子

#### 4.3.2 因子引用规则

- `factor_refs` 只能引用因子本体中 **existing** 状态的因子 ID
- 禁止在代码中硬编码未入库的因子
- 新因子必须先走因子入库流程

### 4.4 工作流程

1. **完成 Markdown 精校**（L1+L2+因子层）
2. **创建 Python 文件**：在 `典籍/{书名}/semantic/` 目录
3. **编写 Python 类**：继承 `SemanticEntry`，使用装饰器注册
4. **本地验证**：确保可以导入，无语法错误
5. **复制到工程目录**：`backend/semantics/{book_id}/`
6. **系统自动处理**：启动时注册、同步数据库、建立缓存

### 4.5 参考资源

- **架构文档**：`/backend/semantics/README.md`
- **示例代码**：`/backend/semantics/dts/_example.py`
- **基类定义**：`/backend/semantics/core/base.py`
- **精校模板**：`/典籍/精校模板_L1L2.md`

---

## 5. 标准样板与一致性

- 《滴天髓·通天论》1–8 条的 L1/L2/因子层 + Python 语义实现，构成本手册的 **标准样板**
- 所有典籍结构化作业（包括中文古籍与西方经典）必须：
  - **流程层面**：严格遵守本手册
  - **字段与表头**：与样板保持一致
  - **技术栈**：统一使用 Python + PostgreSQL + Redis
- 任何偏离必须通过规范变更流程，不得在单条条目中私自修改

---

**最后更新**: 2025-11-24  
**版本**: v2.0-python-semantic  
**维护者**: Semantics-Agent


